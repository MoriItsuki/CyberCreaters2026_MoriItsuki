//============================================================================================================================
//	アイテムCPP
//
//
//============================================================================================================================

//================================================
//	インクルード
//================================================
#include "item.h"
#include "texture.h"

using namespace std;

//================================================
//	定数
//================================================
namespace
{
	using vec3 = D3DXVECTOR3;
}

//================================================
//	静的メンバ変数初期化
//================================================
const std::string CItem::FILE_ITEM = "data\\texture\\bolt.png";

//================================================
//	コンストラクタ
//================================================
CItem::CItem() :
	m_bOut(false)
{
	Init();
}

//================================================
//	デストラクタ
//================================================
CItem::~CItem()
{
	Uninit();
}

//================================================
//	初期化
//================================================
HRESULT CItem::Init()
{
	if (FAILED(CObjectX::Init()))
	{
		return E_FAIL;
	}

	//オブジェクトタイプを"アイテム"にする
	CObject::SetType(ITEM);

	m_ModelFile = "data\\model\\bolt.x";

	m_scale = { 4.0f, 4.0f, 4.0f };

	//テクスチャ作成
	CTexture* pTex = CManager::GetTexture();	//テクスチャ情報取得
	BindTexture(pTex->GetAddress(pTex->Regist(FILE_ITEM)));	//設定

	return S_OK;
}

//================================================
//	終了
//================================================
void CItem::Uninit()
{
	CObjectX::Uninit();
}

//================================================
//	更新
//================================================
void CItem::Update()
{
	CObjectX::Update();

	m_rot.y += D3DX_PI * 0.01f;

	//フラグが立ってたら消す
	if (m_bOut)
	{
		Release();
		return;
	}
}

//================================================
//	描画
//================================================
void CItem::Draw()
{
	CObjectX::Draw();
}

//================================================
//	生成処理
//================================================
CItem* CItem::Create(D3DXVECTOR3 pos)
{
	CItem* pItem = new CItem();
	pItem->Init();
	pItem->SetPos(pos);
	pItem->SetRot({ D3DX_PI * 0.1f,0.0f,0.0f });

	return pItem;
}

//================================================
//	消えるフラグを立てる
//================================================
void CItem::OutOn()
{
	m_bOut = true;
}
